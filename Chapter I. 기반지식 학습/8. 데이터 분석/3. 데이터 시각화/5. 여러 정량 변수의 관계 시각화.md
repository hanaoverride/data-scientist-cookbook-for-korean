# 5. 다변량 관계 시각화: 산점도, 페어플롯, 히트맵

## 목차
- [5. 다변량 관계 시각화: 산점도, 페어플롯, 히트맵](#5-다변량-관계-시각화-산점도-페어플롯-히트맵)
  - [목차](#목차)
  - [두 변수의 관계 보기: 산점도 (Scatter Plot)](#두-변수의-관계-보기-산점도-scatter-plot)
  - [모든 변수 간의 관계를 한눈에: 페어플롯 (Pair Plot)](#모든-변수-간의-관계를-한눈에-페어플롯-pair-plot)
  - [상관계수를 시각화하기: 히트맵 (Heatmap)](#상관계수를-시각화하기-히트맵-heatmap)

---

## 두 변수의 관계 보기: 산점도 (Scatter Plot)

**산점도**는 두 개의 **연속형(정량적) 변수** 간의 관계를 파악하기 위한 가장 기본적인 그래프입니다. 각 데이터 포인트를 X축과 Y축의 값에 해당하는 2차원 평면에 점으로 표시합니다.

- **산점도로 파악할 수 있는 것**:
    - **관계의 형태**: 선형, 곡선, 또는 아무런 관계가 없는지.
    - **관계의 방향**: 양의 상관관계(우상향) 또는 음의 상관관계(우하향).
    - **관계의 강도**: 점들이 특정 패턴(주로 직선) 주위에 얼마나 밀집해 있는지.

`seaborn`의 `scatterplot`이나 `regplot`을 사용하면 추세선(회귀선)을 함께 그려 관계를 더 명확하게 파악할 수 있습니다.

```python
import seaborn as sns
import matplotlib.pyplot as plt

# seaborn에 내장된 'tips' 데이터셋 사용
tips = sns.load_dataset("tips")

# 총 식사 금액(total_bill)과 팁(tip)의 관계
sns.regplot(x="total_bill", y="tip", data=tips, scatter_kws={'alpha':0.5})
plt.title('식사 금액과 팁의 관계 (산점도)')
plt.show()
```

> **색상(`hue`)으로 차원 추가하기**: `hue` 파라미터에 범주형 변수를 지정하면, 점의 색상을 그룹별로 다르게 하여 제3의 변수가 두 변수의 관계에 미치는 영향을 함께 볼 수 있습니다.

```python
# 흡연 여부(smoker)에 따라 색상을 다르게 표시
sns.scatterplot(x="total_bill", y="tip", hue="smoker", data=tips)
plt.title('흡연 여부에 따른 식사 금액과 팁의 관계')
plt.show()
```

---

## 모든 변수 간의 관계를 한눈에: 페어플롯 (Pair Plot)

데이터에 여러 개의 숫자형 변수가 있을 때, 모든 변수 쌍 간의 관계를 일일이 산점도로 그려보는 것은 번거롭습니다. **페어플롯**은 이러한 작업을 단 한 줄의 코드로 해결해줍니다.

`seaborn`의 `pairplot`은 데이터프레임의 모든 숫자형 변수 쌍에 대한 **산점도**를 그리고, 대각선 위치에는 각 변수 자체의 **분포(히스토그램 또는 KDE)** 를 그려주는 매우 강력한 탐색적 데이터 분석(EDA) 도구입니다.

```python
# tips 데이터셋의 숫자형 변수들 간의 관계를 모두 보여줌
sns.pairplot(tips, hue="smoker") # 흡연 여부에 따라 색상 구분
plt.show()
```
> `pairplot`을 통해 어떤 변수들 사이에 선형 관계가 있는지, 어떤 변수가 정규분포를 따르는지 등 데이터의 전체적인 구조를 매우 빠르게 파악할 수 있습니다.

---

## 상관계수를 시각화하기: 히트맵 (Heatmap)

**상관계수 행렬(Correlation Matrix)** 은 모든 변수 쌍 간의 피어슨 상관계수(-1에서 1 사이의 값)를 계산하여 행렬 형태로 나타낸 것입니다. Pandas의 `.corr()` 메서드를 사용하면 쉽게 계산할 수 있습니다.

이 상관계수 행렬 자체는 숫자로만 이루어져 있어 한눈에 관계를 파악하기 어렵습니다. 이때 **히트맵(Heatmap)** 을 사용하면, 상관계수의 크기를 색상의 농도로 표현하여 어떤 변수들 간에 강한 상관관계가 있는지 직관적으로 파악할 수 있습니다.

```python
# 1. 숫자형 변수만 선택하여 상관계수 행렬 계산
corr_matrix = tips.corr(numeric_only=True)

# 2. 히트맵으로 시각화
plt.figure(figsize=(8, 6))
sns.heatmap(corr_matrix, annot=True, cmap='coolwarm', vmin=-1, vmax=1)
# annot=True: 각 셀에 숫자 값을 표시
# cmap='coolwarm': 색상 맵 지정 (양수는 따뜻한 색, 음수는 차가운 색)
# vmin, vmax: 색상 맵의 최소/최대값 범위를 -1과 1로 고정

plt.title('변수 간 상관계수 히트맵')
plt.show()
```
> 히트맵을 통해, 붉은색이 진할수록 강한 양의 상관관계, 푸른색이 진할수록 강한 음의 상관관계가 있음을 한눈에 알 수 있습니다.